webpackJsonp([1,32,58,68,75],{"9cbi":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("PJh5");a.n(n).a.locale("zh-cn");var s={name:"PaymentView",props:{paymentShow:{type:Boolean,default:!1},paymentData:{type:Object}},computed:{show:{get:function(){return this.paymentShow},set:function(){}}},data:function(){return{loading:!1}},methods:{onClose:function(){this.$emit("close")}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:"缴费管理详情",width:800},on:{cancel:t.onClose},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("template",{slot:"footer"},[a("a-button",{key:"back",attrs:{type:"danger"},on:{click:t.onClose}},[t._v("\n      关闭\n    ")])],1),t._v(" "),null!==t.paymentData?a("div",{staticStyle:{"font-size":"13px"}},[a("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[a("a-col",{staticStyle:{"margin-bottom":"15px"}},[a("span",{staticStyle:{"font-size":"15px","font-weight":"650",color:"#000c17"}},[t._v("基础信息")])]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("业主姓名：")]),t._v("\n        "+t._s(t.paymentData.name)+"\n      ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("联系电话：")]),t._v("\n        "+t._s(t.paymentData.phone)+"\n      ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("身份证号：")]),t._v(" "),a("a-tooltip",[a("template",{slot:"title"},[t._v("\n            "+t._s(t.paymentData.idNumber)+"\n          ")]),t._v("\n          "+t._s(t.paymentData.idNumber.slice(0,10))+" ...\n        ")],2)],1)],1),t._v(" "),a("br"),t._v(" "),a("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[a("a-col",{attrs:{span:8}},[a("b",[t._v("收取年份：")]),t._v("\n        "+t._s(t.paymentData.year)+" 年\n      ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("收取月份：")]),t._v("\n        "+t._s(t.paymentData.month)+" 月\n      ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("房屋地址：")]),t._v(" "),a("a-tooltip",[a("template",{slot:"title"},[t._v("\n            "+t._s(t.paymentData.address)+"\n          ")]),t._v("\n          "+t._s(t.paymentData.address.slice(0,10))+" ...\n        ")],2)],1)],1),t._v(" "),a("br"),t._v(" "),a("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[a("a-col",{attrs:{span:8}},[a("b",[t._v("缴费类型：")]),t._v("\n        "+t._s(t.paymentData.propertyName)+"\n      ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("本月消耗：")]),t._v(" "),1==t.paymentData.type||2==t.paymentData.type?a("span",[t._v(t._s(t.paymentData.propertyName)+" "+t._s(t.paymentData.dosage)+" "+t._s(t.paymentData.propertyUnit))]):a("span",[t._v("- -")])]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("需缴费用：")]),t._v("\n        "+t._s(t.paymentData.price)+" 元\n      ")])],1),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[a("a-col",{staticStyle:{"margin-bottom":"15px"}},[a("span",{staticStyle:{"font-size":"15px","font-weight":"650",color:"#000c17"}},[t._v("电费梯度计算")])]),t._v(" "),a("a-col",{attrs:{span:24}},[a("b",[t._v("第一档电量：")]),t._v("\n        每户每月0~200度 电费不做调整\n      ")]),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("a-col",{attrs:{span:24}},[a("b",[t._v("第二档电量：")]),t._v("\n        每户每月201~400度 电价每度加0.05\n      ")]),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("a-col",{attrs:{span:24}},[a("b",[t._v("第三档电量：")]),t._v("\n        每户每月400度以上 电价每度加0.3\n      ")])],1),t._v(" "),a("br")],1):t._e()],2)},staticRenderFns:[]},i=a("VU/8")(s,o,!1,function(t){a("a8Om")},"data-v-4215bdbb",null);e.default=i.exports},DOTJ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(a("mvHQ"),a("Dd8w")),s=a.n(n),o=a("JpjP"),i=a("nlDa"),r=a("EJCh"),l=a("9cbi"),c=a("NYxO"),u=a("PJh5"),p=a.n(u),d=a("iJAC");p.a.locale("zh-cn");var v={name:"payment",components:{PaymentAddNew:d.default,PaymentAdd:i.default,PaymentEdit:r.default,PaymentView:l.default,RangeDate:o.a},data:function(){return{advanced:!1,paymentAdd:{visiable:!1},paymentEdit:{visiable:!1},paymentView:{visiable:!1,data:null},queryParams:{},filteredInfo:null,sortedInfo:null,paginationInfo:null,dataSource:[],selectedRowKeys:[],loading:!1,pagination:{pageSizeOptions:["10","20","30","40","100"],defaultCurrent:1,defaultPageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(t,e){return"显示 "+e[0]+" ~ "+e[1]+" 条记录，共 "+t+" 条记录"}},propertyList:[]}},computed:s()({},Object(c.c)({currentUser:function(t){return t.account.user}}),{columns:function(){var t=this.$createElement;return[{title:"所属房屋",dataIndex:"address",scopedSlots:{customRender:"addressShow"}},{title:"业主姓名",dataIndex:"name"},{title:"联系方式",dataIndex:"phone"},{title:"缴费金额",dataIndex:"price",customRender:function(t,e,a){return null!==t?"￥"+t:"- -"}},{title:"缴费类型",dataIndex:"propertyName",scopedSlots:{customRender:"propertyNameShow"}},{title:"计算方式",dataIndex:"propertyType",customRender:function(e,a,n){switch(e){case 1:return t("a-tag",["统一交付"]);case 2:return t("a-tag",["按量计算"]);default:return"- -"}}},{title:"费用时间",dataIndex:"year",customRender:function(t,e,a){return e.year+"年"+e.month+"月"}},{title:"缴费状态",dataIndex:"createDate",customRender:function(e,a,n){return null!==e?t("a-tag",{attrs:{color:"green"}},["已缴费"]):t("a-tag",{attrs:{color:"red"}},["未缴费"])}},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}]}}),mounted:function(){this.fetch(),this.getPropertyList()},methods:{getPropertyList:function(){var t=this;this.$get("/cos/property-item/list").then(function(e){t.propertyList=e.data.data})},view:function(t){this.paymentView.data=t,this.paymentView.visiable=!0},handlePaymentViewClose:function(){this.paymentView.visiable=!1},onSelectChange:function(t){this.selectedRowKeys=t},toggleAdvanced:function(){this.advanced=!this.advanced},add:function(){this.paymentAdd.visiable=!0},handlePaymentAddClose:function(){this.paymentAdd.visiable=!1},handlePaymentAddSuccess:function(){this.paymentAdd.visiable=!1,this.$message.success("添加成功"),this.search()},edit:function(t){this.$refs.paymentEdit.setFormValues(t),this.paymentEdit.visiable=!0},handlePaymentEditClose:function(){this.paymentEdit.visiable=!1},handlePaymentEditSuccess:function(){this.paymentEdit.visiable=!1,this.$message.success("修改工作人员成功"),this.search()},handleDeptChange:function(t){this.queryParams.deptId=t||""},batchDelete:function(){if(this.selectedRowKeys.length){var t=this;this.$confirm({title:"确定删除所选中的记录?",content:"当您点击确定按钮后，这些记录将会被彻底删除",centered:!0,onOk:function(){var e=t.selectedRowKeys.join(",");t.$delete("/cos/payment-info/"+e).then(function(){t.$message.success("删除成功"),t.selectedRowKeys=[],t.search()})},onCancel:function(){t.selectedRowKeys=[]}})}else this.$message.warning("请选择需要删除的记录")},search:function(){var t=this.sortedInfo,e=this.filteredInfo,a=void 0,n=void 0;t&&(a=t.field,n=t.order),this.fetch(s()({sortField:a,sortOrder:n},this.queryParams,e))},reset:function(){this.selectedRowKeys=[],this.$refs.TableInfo.pagination.current=this.pagination.defaultCurrent,this.paginationInfo&&(this.paginationInfo.current=this.pagination.defaultCurrent,this.paginationInfo.pageSize=this.pagination.defaultPageSize),this.filteredInfo=null,this.sortedInfo=null,this.queryParams={},this.fetch()},handleTableChange:function(t,e,a){this.paginationInfo=t,this.filteredInfo=e,this.sortedInfo=a,this.fetch(s()({sortField:a.field,sortOrder:a.order},this.queryParams,e))},fetch:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,this.paginationInfo?(this.$refs.TableInfo.pagination.current=this.paginationInfo.current,this.$refs.TableInfo.pagination.pageSize=this.paginationInfo.pageSize,e.size=this.paginationInfo.pageSize,e.current=this.paginationInfo.current):(e.size=this.pagination.defaultPageSize,e.current=this.pagination.defaultCurrent),void 0===e.type&&delete e.type,void 0===e.payStatus&&delete e.payStatus,void 0===e.year&&delete e.year,void 0===e.month&&delete e.month,this.$get("/cos/payment-manage/page",s()({},e)).then(function(e){var a=e.data.data,n=s()({},t.pagination);n.total=a.total,t.dataSource=a.records,t.pagination=n,t.loading=!1})}},watch:{}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",{staticClass:"card-area",attrs:{bordered:!1}},[a("div",{class:t.advanced?"search":null},[a("a-form",{attrs:{layout:"horizontal"}},[a("a-row",{attrs:{gutter:15}},[a("div",{class:t.advanced?null:"fold"},[a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"业主姓名",labelCol:{span:4},wrapperCol:{span:18,offset:2}}},[a("a-input",{model:{value:t.queryParams.name,callback:function(e){t.$set(t.queryParams,"name",e)},expression:"queryParams.name"}})],1)],1),t._v(" "),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"房屋地址",labelCol:{span:4},wrapperCol:{span:18,offset:2}}},[a("a-input",{model:{value:t.queryParams.address,callback:function(e){t.$set(t.queryParams,"address",e)},expression:"queryParams.address"}})],1)],1),t._v(" "),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"缴费类型",labelCol:{span:4},wrapperCol:{span:18,offset:2}}},[a("a-select",{attrs:{allowClear:""},model:{value:t.queryParams.type,callback:function(e){t.$set(t.queryParams,"type",e)},expression:"queryParams.type"}},t._l(t.propertyList,function(e,n){return a("a-select-option",{key:n,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],1)],1),t._v(" "),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"缴费状态",labelCol:{span:4},wrapperCol:{span:18,offset:2}}},[a("a-select",{attrs:{allowClear:""},model:{value:t.queryParams.payStatus,callback:function(e){t.$set(t.queryParams,"payStatus",e)},expression:"queryParams.payStatus"}},[a("a-select-option",{attrs:{value:"1"}},[t._v("未缴费")]),t._v(" "),a("a-select-option",{attrs:{value:"2"}},[t._v("已缴费")])],1)],1)],1)],1),t._v(" "),t.advanced?a("a-row",{attrs:{gutter:15}},[a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"缴费年份",labelCol:{span:4},wrapperCol:{span:18,offset:2}}},[a("a-select",{attrs:{allowClear:""},model:{value:t.queryParams.year,callback:function(e){t.$set(t.queryParams,"year",e)},expression:"queryParams.year"}},[a("a-select-option",{attrs:{value:"2022"}},[t._v("2022")]),t._v(" "),a("a-select-option",{attrs:{value:"2023"}},[t._v("2023")]),t._v(" "),a("a-select-option",{attrs:{value:"2024"}},[t._v("2024")]),t._v(" "),a("a-select-option",{attrs:{value:"2025"}},[t._v("2025")]),t._v(" "),a("a-select-option",{attrs:{value:"2026"}},[t._v("2026")]),t._v(" "),a("a-select-option",{attrs:{value:"2027"}},[t._v("2027")]),t._v(" "),a("a-select-option",{attrs:{value:"2028"}},[t._v("2028")]),t._v(" "),a("a-select-option",{attrs:{value:"2029"}},[t._v("2029")]),t._v(" "),a("a-select-option",{attrs:{value:"2030"}},[t._v("2030")]),t._v(" "),a("a-select-option",{attrs:{value:"2031"}},[t._v("2031")])],1)],1)],1),t._v(" "),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"缴费月份",labelCol:{span:4},wrapperCol:{span:18,offset:2}}},[a("a-select",{attrs:{allowClear:""},model:{value:t.queryParams.month,callback:function(e){t.$set(t.queryParams,"month",e)},expression:"queryParams.month"}},[a("a-select-option",{attrs:{value:"1"}},[t._v("1")]),t._v(" "),a("a-select-option",{attrs:{value:"2"}},[t._v("2")]),t._v(" "),a("a-select-option",{attrs:{value:"3"}},[t._v("3")]),t._v(" "),a("a-select-option",{attrs:{value:"4"}},[t._v("4")]),t._v(" "),a("a-select-option",{attrs:{value:"5"}},[t._v("5")]),t._v(" "),a("a-select-option",{attrs:{value:"6"}},[t._v("6")]),t._v(" "),a("a-select-option",{attrs:{value:"7"}},[t._v("7")]),t._v(" "),a("a-select-option",{attrs:{value:"8"}},[t._v("8")]),t._v(" "),a("a-select-option",{attrs:{value:"9"}},[t._v("9")]),t._v(" "),a("a-select-option",{attrs:{value:"10"}},[t._v("10")]),t._v(" "),a("a-select-option",{attrs:{value:"11"}},[t._v("11")]),t._v(" "),a("a-select-option",{attrs:{value:"12"}},[t._v("12")])],1)],1)],1)],1):t._e(),t._v(" "),a("span",{staticStyle:{float:"right","margin-top":"3px"}},[a("a-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")]),t._v(" "),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.reset}},[t._v("重置")]),t._v(" "),a("a",{staticStyle:{"margin-left":"8px"},on:{click:t.toggleAdvanced}},[t._v("\n            "+t._s(t.advanced?"收起":"展开")+"\n            "),a("a-icon",{attrs:{type:t.advanced?"up":"down"}})],1)],1)],1)],1)],1),t._v(" "),a("div",[a("div",{staticClass:"operator"},[a("a-button",{attrs:{type:"primary",ghost:""},on:{click:t.add}},[t._v("新增")]),t._v(" "),a("a-button",{on:{click:t.batchDelete}},[t._v("删除")])],1),t._v(" "),a("a-table",{ref:"TableInfo",attrs:{columns:t.columns,rowKey:function(t){return t.id},dataSource:t.dataSource,pagination:t.pagination,loading:t.loading,rowSelection:{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange},scroll:{x:900}},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"propertyNameShow",fn:function(e,n){return[[1==n.type||2==n.type?a("a-tooltip",[a("template",{slot:"title"},[t._v("\n                本月消耗 - "+t._s(n.dosage)+" "+t._s(n.propertyUnit)+"\n              ")]),t._v(" "),a("a",[t._v(t._s(n.propertyName))])],2):a("span",[t._v(t._s(n.propertyName))])]]}},{key:"addressShow",fn:function(e,n){return[[a("a-tooltip",[a("template",{slot:"title"},[t._v("\n                "+t._s(n.address)+"\n              ")]),t._v("\n              "+t._s(n.address.slice(0,10))+" ...\n            ")],2)]]}},{key:"operation",fn:function(e,n){return[a("a-icon",{attrs:{type:"reconciliation",title:"查 看"},on:{click:function(e){t.view(n)}}})]}}])})],1),t._v(" "),t.paymentAdd.visiable?a("payment-add",{attrs:{paymentAddVisiable:t.paymentAdd.visiable},on:{close:t.handlePaymentAddClose,success:t.handlePaymentAddSuccess}}):t._e(),t._v(" "),a("payment-edit",{ref:"paymentEdit",attrs:{paymentEditVisiable:t.paymentEdit.visiable},on:{close:t.handlePaymentEditClose,success:t.handlePaymentEditSuccess}}),t._v(" "),a("payment-view",{attrs:{paymentShow:t.paymentView.visiable,paymentData:t.paymentView.data},on:{close:t.handlePaymentViewClose}})],1)},staticRenderFns:[]},m=a("VU/8")(v,h,!1,function(t){a("lxc6")},"data-v-62d003a0",null);e.default=m.exports},EJCh:function(t,e,a){"use strict";function n(t){return new m.a(function(e,a){var n=new FileReader;n.readAsDataURL(t),n.onload=function(){return e(n.result)},n.onerror=function(t){return a(t)}})}Object.defineProperty(e,"__esModule",{value:!0});var s=a("fZjL"),o=a.n(s),i=a("+6Bu"),r=a.n(i),l=a("Xxa5"),c=a.n(l),u=a("exGp"),p=a.n(u),d=a("Dd8w"),v=a.n(d),h=a("//Fk"),m=a.n(h),_=a("NYxO"),f={labelCol:{span:24},wrapperCol:{span:24}},y={name:"paymentEdit",props:{paymentEditVisiable:{default:!1}},computed:v()({},Object(_.c)({currentUser:function(t){return t.account.user}}),{show:{get:function(){return this.paymentEditVisiable},set:function(){}}}),data:function(){return{rowId:null,formItemLayout:f,form:this.$form.createForm(this),loading:!1,fileList:[],previewVisible:!1,previewImage:""}},methods:{handleCancel:function(){this.previewVisible=!1},handlePreview:function(t){var e=this;return p()(c.a.mark(function a(){return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t.url||t.preview){a.next=4;break}return a.next=3,n(t.originFileObj);case 3:t.preview=a.sent;case 4:e.previewImage=t.url||t.preview,e.previewVisible=!0;case 6:case"end":return a.stop()}},a,e)}))()},picHandleChange:function(t){var e=t.fileList;this.fileList=e},imagesInit:function(t){if(null!==t&&""!==t){var e=[];t.split(",").forEach(function(t,a){e.push({uid:a,name:t,status:"done",url:"http://backend.my.org/imagesWeb/"+t})}),this.fileList=e}},setFormValues:function(t){var e=this,a=r()(t,[]);this.rowId=a.id;var n=["name","phone","type"],s={};o()(a).forEach(function(t){"images"===t&&(e.fileList=[],e.imagesInit(a.images)),"type"===t&&(a[t]=a[t].toString()),-1!==n.indexOf(t)&&(e.form.getFieldDecorator(t),s[t]=a[t])}),this.form.setFieldsValue(s)},reset:function(){this.loading=!1,this.form.resetFields()},onClose:function(){this.reset(),this.$emit("close")},handleSubmit:function(){var t=this,e=[];this.fileList.forEach(function(t){e.push(t.name)}),this.form.validateFields(function(a,n){n.id=t.rowId,n.image=e.length>0?e.join(","):null,a||(t.loading=!0,t.$put("/cos/payment-manage",v()({},n)).then(function(e){t.reset(),t.$emit("success")}).catch(function(){t.loading=!1}))})}}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:"修改工作人员",width:800},on:{cancel:t.onClose},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("template",{slot:"footer"},[a("a-button",{key:"back",on:{click:t.onClose}},[t._v("\n      取消\n    ")]),t._v(" "),a("a-button",{key:"submit",attrs:{type:"primary",loading:t.loading},on:{click:t.handleSubmit}},[t._v("\n      修改\n    ")])],1),t._v(" "),a("a-form",{attrs:{form:t.form,layout:"vertical"}},[a("a-row",{attrs:{gutter:20}},[a("a-col",{attrs:{span:12}},[a("a-form-item",t._b({attrs:{label:"人员姓名"}},"a-form-item",t.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入人员姓名!"}]}],expression:"[\n          'name',\n          { rules: [{ required: true, message: '请输入人员姓名!' }] }\n          ]"}]})],1)],1),t._v(" "),a("a-col",{attrs:{span:12}},[a("a-form-item",t._b({attrs:{label:"联系方式"}},"a-form-item",t.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["phone",{rules:[{required:!0,message:"请输入联系方式!"}]}],expression:"[\n          'phone',\n          { rules: [{ required: true, message: '请输入联系方式!' }] }\n          ]"}]})],1)],1),t._v(" "),a("a-col",{attrs:{span:12}},[a("a-form-item",t._b({attrs:{label:"人员类型"}},"a-form-item",t.formItemLayout,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["type",{rules:[{required:!0,message:"请输入人员类型!"}]}],expression:"[\n            'type',\n            { rules: [{ required: true, message: '请输入人员类型!' }] }\n            ]"}]},[a("a-select-option",{attrs:{value:"1"}},[t._v("物业管理员")]),t._v(" "),a("a-select-option",{attrs:{value:"2"}},[t._v("维修人员")]),t._v(" "),a("a-select-option",{attrs:{value:"3"}},[t._v("抄表员")]),t._v(" "),a("a-select-option",{attrs:{value:"4"}},[t._v("保洁员")])],1)],1)],1),t._v(" "),a("a-col",{attrs:{span:24}},[a("a-form-item",t._b({attrs:{label:"照片"}},"a-form-item",t.formItemLayout,!1),[a("a-upload",{attrs:{name:"avatar",action:"http://backend.my.org/file/fileUpload/","list-type":"picture-card","file-list":t.fileList},on:{preview:t.handlePreview,change:t.picHandleChange}},[t.fileList.length<8?a("div",[a("a-icon",{attrs:{type:"plus"}}),t._v(" "),a("div",{staticClass:"ant-upload-text"},[t._v("\n                Upload\n              ")])],1):t._e()]),t._v(" "),a("a-modal",{attrs:{visible:t.previewVisible,footer:null},on:{cancel:t.handleCancel}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:t.previewImage}})])],1)],1)],1)],1)],2)},staticRenderFns:[]},b=a("VU/8")(y,g,!1,function(t){a("ln8l")},"data-v-2e58675c",null);e.default=b.exports},Im6d:function(t,e){},a8Om:function(t,e){},iJAC:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("gRE1"),s=a.n(n),o=a("mvHQ"),i=a.n(o),r=a("Dd8w"),l=a.n(r),c=a("NYxO"),u=a("PJh5"),p=a.n(u),d={labelCol:{span:24},wrapperCol:{span:24}},v={name:"PaymentAddNew",props:{paymentAddVisiable:{default:!1}},computed:l()({},Object(c.c)({currentUser:function(t){return t.account.user}}),{show:{get:function(){return this.paymentAddVisiable},set:function(){}}}),mounted:function(){this.getPropertyList(),this.getHousesList()},data:function(){return{formItemLayout:d,form:this.$form.createForm(this),loading:!1,fileList:[],previewVisible:!1,previewImage:"",housesData:null,consumptionInfo:[],housesId:null,propertyList:[],housesList:[],energyNow:0,waterNow:0,energyUsed:0,waterUsed:0,electricityBill:0,waterBill:0,checkMonth:null}},methods:{energyChange:function(){var t=this,e=0;this.propertyList.forEach(function(t){1===t.id&&(e=t.price)}),0===this.consumptionInfo.length?this.electricityBill=this.electricityCalculation(this.energyNow,e):this.consumptionInfo.forEach(function(a){if(1===a.type){var n=t.energyNow-a.dose;t.electricityBill=t.electricityCalculation(n,e)}})},electricityCalculation:function(t,e){var a=0,n=0,s=0;return t>400?(s=((t-400)*(e+.3)).toFixed(2),a=(400*e).toFixed(2)):t>200?(n=((t-200)*(e+.05)).toFixed(2),a=(200*e).toFixed(2)):t<=200&&(a=(t*e).toFixed(2)),Number(a)+Number(n)+Number(s)},waterChange:function(){var t=this,e=0;this.propertyList.forEach(function(t){2===t.id&&(e=t.price)}),0===this.consumptionInfo.length?this.waterBill=(this.waterNow*e).toFixed(2):this.consumptionInfo.forEach(function(a){2===a.type&&(t.waterBill=((t.waterNow-a.dose)*e).toFixed(2))})},housesChange:function(t,e){var a=this;this.housesList.forEach(function(e){e.id===t&&(a.housesData=e)}),this.housesConsumption(t),t&&(this.housesId=t)},housesConsumption:function(t){var e=this;this.$get("/cos/houses-info/housesConsumption",{housesId:t}).then(function(t){e.consumptionInfo=t.data.data})},filterOption:function(t,e){return e.componentOptions.address[0].text.toLowerCase().indexOf(t.toLowerCase())>=0},getPropertyList:function(){var t=this;this.$get("/cos/property-item/list").then(function(e){t.propertyList=e.data.data})},getHousesList:function(){var t=this;this.$get("/cos/houses-info/list").then(function(e){t.housesList=e.data.data})},reset:function(){this.loading=!1,this.form.resetFields()},onClose:function(){this.reset(),this.$emit("close")},handleSubmit:function(){var t=this;return this.housesId?this.checkMonth?void this.$get("/cos/houses-info/housesConsumptionCheck",{housesId:this.housesId,date:p()(this.checkMonth).format("YYYY-MM-01")}).then(function(e){if(0!==e.data.data.length)t.$message.warning("该房屋本月已进行清算！");else{var a=[],n=[];t.propertyList.forEach(function(e){var s=0,o=e.price;1!==e.id&&2!==e.id||(n.push({housesId:t.housesId,type:e.id,year:(new Date).getFullYear(),month:Number((new Date).getMonth())+1,dose:1===e.id?t.energyNow:t.waterNow}),0===t.consumptionInfo.length?s=1===e.id?t.energyNow:t.waterNow:t.consumptionInfo.forEach(function(a){e.id===a.type&&1===e.id&&(s=Number(t.energyNow)-Number(a.dose)),e.id===a.type&&2===e.id&&(s=Number(t.waterNow)-Number(a.dose))}),1===e.id&&(o=t.electricityBill),2===e.id&&(o=t.waterBill)),3===e.id&&(o=e.price*t.housesData.usageArea),a.push({housesId:t.housesId,type:e.id,year:p()(t.checkMonth).format("YYYY"),month:p()(t.checkMonth).format("MM"),dosage:s,price:o})}),t.$post("/cos/payment-manage/addPaymentManage",{paymentManageStr:i()(s()(a))}).then(function(e){t.$post("/cos/consumption-info/addConsumption",{consumptionInfoStr:i()(s()(n))}).then(function(e){t.electricityBill=0,t.waterBill=0,t.$emit("success")}).catch(function(){t.loading=!1})}).catch(function(){t.loading=!1})}}):(this.$message.warning("请选择清算日期！"),!1):(this.$message.warning("请选择房屋！"),!1)}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:"抄表入库",width:800},on:{cancel:t.onClose},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("template",{slot:"footer"},[a("a-button",{key:"back",on:{click:t.onClose}},[t._v("\n      取消\n    ")]),t._v(" "),a("a-button",{key:"submit",attrs:{type:"primary",loading:t.loading},on:{click:t.handleSubmit}},[t._v("\n      提交\n    ")])],1),t._v(" "),a("div",[a("a-row",{attrs:{gutter:20}},[a("a-col",{attrs:{span:14}},[a("a-form-item",t._b({attrs:{label:"所属房屋"}},"a-form-item",t.formItemLayout,!1),[a("a-select",{staticStyle:{width:"100%"},attrs:{showSearch:"",optionFilterProp:"children"},on:{change:t.housesChange},model:{value:t.housesId,callback:function(e){t.housesId=e},expression:"housesId"}},t._l(t.housesList,function(e,n){return a("a-select-option",{key:n,attrs:{value:e.id}},[t._v(t._s(e.address))])}))],1)],1),t._v(" "),a("a-col",{attrs:{span:8}},[a("a-form-item",t._b({attrs:{label:"缴费月度"}},"a-form-item",t.formItemLayout,!1),[a("a-month-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"Select month"},model:{value:t.checkMonth,callback:function(e){t.checkMonth=e},expression:"checkMonth"}},[a("a-icon",{attrs:{slot:"suffixIcon",type:"smile"},slot:"suffixIcon"})],1)],1)],1),t._v(" "),null!==t.housesData?a("a-col",{attrs:{span:24}},[a("a-row",[a("a-col",{staticStyle:{"margin-bottom":"15px"}},[a("span",{staticStyle:{"font-size":"15px","font-weight":"650",color:"#000c17"}},[t._v("房屋信息")])]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("房间号：")]),t._v("\n            "+t._s(t.housesData.number)+" 室\n          ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("房屋地址：")]),t._v(" "),a("a-tooltip",[a("template",{slot:"title"},[t._v("\n                "+t._s(t.housesData.address)+"\n              ")]),t._v("\n              "+t._s(t.housesData.address.slice(0,10))+" ...\n            ")],2)],1),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("楼层：")]),t._v("\n            "+t._s(t.housesData.floor)+" 层\n          ")])],1),t._v(" "),a("br"),t._v(" "),a("a-row",[a("a-col",{attrs:{span:8}},[a("b",[t._v("使用面积：")]),t._v("\n            "+t._s(t.housesData.usageArea)+" ㎡\n          ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("建筑面积：")]),t._v("\n            "+t._s(t.housesData.surfaceArea)+" ㎡\n          ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("房屋类型：")]),t._v(" "),1==t.housesData.nature?a("span",[t._v("住宅楼房")]):t._e(),t._v(" "),2==t.housesData.nature?a("span",[t._v("社区用处")]):t._e()])],1),t._v(" "),a("br"),t._v(" "),a("a-row",[a("a-col",{attrs:{span:8}},[a("b",[t._v("间 数：")]),t._v("\n            "+t._s(t.housesData.rooms)+" 间\n          ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("购房人：")]),t._v("\n            "+t._s(t.housesData.buyer)+"\n          ")])],1),t._v(" "),a("br"),t._v(" "),a("br")],1):t._e(),t._v(" "),a("a-col",{attrs:{span:24}},t._l(t.propertyList,function(e,n){return a("a-row",{key:n},[a("a-col",{staticStyle:{"margin-bottom":"15px"}},[a("span",{staticStyle:{"font-size":"15px","font-weight":"650",color:"#000c17"}},[t._v("\n            "+t._s(e.name)+" -\n            "),1==e.type?a("span",[t._v("统一交付")]):t._e(),t._v(" "),2==e.type?a("span",[t._v("\n              按量计算\n              "),1==e.id?a("span",[a("a-tooltip",[a("template",{slot:"title"},[a("p",[t._v("第一档电量：每户每月0~200度 电费不做调整")]),t._v(" "),a("p",[t._v("第二档电量：每户每月201~400度 电价每度加0.05")]),t._v(" "),a("p",[t._v("第三档电量：每户每月400度以上 电价每度加0.3")])]),t._v(" "),a("a-icon",{attrs:{type:"question"}})],2)],1):t._e()]):t._e()])]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("价 格：")]),t._v(" "),1==e.type?a("span",[t._v(t._s(e.price)+" 元")]):t._e(),t._v(" "),2==e.type?a("span",[t._v(t._s(e.price)+" 元/ "+t._s(e.unit))]):t._e()]),t._v(" "),t._l(t.consumptionInfo,function(n,s){return n.type==e.id&&1==e.id?a("a-col",{key:s,attrs:{span:8}},[a("b",[t._v("上月用电：")]),t._v("\n            "+t._s(n.dose)+" "+t._s(e.unit)+"\n          ")]):t._e()}),t._v(" "),1==e.id&&0===t.consumptionInfo.length&&null!==t.housesData?a("a-col",{attrs:{span:8}},[a("b",[t._v("上月用电：")]),t._v(" - - ")]):t._e(),t._v(" "),1==e.id&&null!==t.housesData?a("a-col",{attrs:{span:8}},[a("b",[t._v("本月电费：")]),t._v(t._s(t.electricityBill)+" 元")]):t._e(),t._v(" "),3==e.id&&null!==t.housesData?a("a-col",{attrs:{span:8}},[a("b",[t._v("物业费用：")]),t._v("\n            "+t._s((t.housesData.usageArea*e.price).toFixed(2))+" 元\n          ")]):t._e(),t._v(" "),t._l(t.consumptionInfo,function(n,s){return n.type==e.id&&2==e.id?a("a-col",{key:s,attrs:{span:8}},[a("b",[t._v("上月用水：")]),t._v("\n            "+t._s(n.dose)+" "+t._s(e.unit)+"\n          ")]):t._e()}),t._v(" "),2==e.id&&0===t.consumptionInfo.length&&null!==t.housesData?a("a-col",{attrs:{span:8}},[a("b",[t._v("上月用水：")]),t._v(" - - ")]):t._e(),t._v(" "),2==e.id&&null!==t.housesData?a("a-col",{attrs:{span:8}},[a("b",[t._v("本月水费：")]),t._v(t._s(t.waterBill)+" 元")]):t._e(),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("br")],2)}))],1)],1)],2)},staticRenderFns:[]},m=a("VU/8")(v,h,!1,function(t){a("Im6d")},"data-v-558717e2",null);e.default=m.exports},ln8l:function(t,e){},lxc6:function(t,e){},nlDa:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("gRE1"),s=a.n(n),o=a("mvHQ"),i=a.n(o),r=a("Dd8w"),l=a.n(r),c=a("NYxO"),u={labelCol:{span:24},wrapperCol:{span:24}},p={name:"PaymentAdd",props:{paymentAddVisiable:{default:!1}},computed:l()({},Object(c.c)({currentUser:function(t){return t.account.user}}),{show:{get:function(){return this.paymentAddVisiable},set:function(){}}}),mounted:function(){this.getPropertyList(),this.getHousesList()},data:function(){return{formItemLayout:u,form:this.$form.createForm(this),loading:!1,fileList:[],previewVisible:!1,previewImage:"",housesData:null,consumptionInfo:[],housesId:null,propertyList:[],housesList:[],energyNow:0,waterNow:0,energyUsed:0,waterUsed:0,electricityBill:0,waterBill:0}},methods:{energyChange:function(){var t=this,e=0;this.propertyList.forEach(function(t){1===t.id&&(e=t.price)}),0===this.consumptionInfo.length?this.electricityBill=this.electricityCalculation(this.energyNow,e):this.consumptionInfo.forEach(function(a){if(1===a.type){var n=t.energyNow-a.dose;t.electricityBill=t.electricityCalculation(n,e)}})},electricityCalculation:function(t,e){var a=0,n=0,s=0;return t>400?(s=((t-400)*(e+.3)).toFixed(2),a=(400*e).toFixed(2)):t>200?(n=((t-200)*(e+.05)).toFixed(2),a=(200*e).toFixed(2)):t<=200&&(a=(t*e).toFixed(2)),Number(a)+Number(n)+Number(s)},waterChange:function(){var t=this,e=0;this.propertyList.forEach(function(t){2===t.id&&(e=t.price)}),0===this.consumptionInfo.length?this.waterBill=(this.waterNow*e).toFixed(2):this.consumptionInfo.forEach(function(a){2===a.type&&(t.waterBill=((t.waterNow-a.dose)*e).toFixed(2))})},housesChange:function(t,e){var a=this;this.housesList.forEach(function(e){e.id===t&&(a.housesData=e)}),this.housesConsumption(t),t&&(this.housesId=t)},housesConsumption:function(t){var e=this;this.$get("/cos/houses-info/housesConsumption",{housesId:t}).then(function(t){e.consumptionInfo=t.data.data})},filterOption:function(t,e){return e.componentOptions.address[0].text.toLowerCase().indexOf(t.toLowerCase())>=0},getPropertyList:function(){var t=this;this.$get("/cos/property-item/list").then(function(e){t.propertyList=e.data.data})},getHousesList:function(){var t=this;this.$get("/cos/houses-info/list").then(function(e){t.housesList=e.data.data})},reset:function(){this.loading=!1,this.form.resetFields()},onClose:function(){this.reset(),this.$emit("close")},handleSubmit:function(){var t=this;this.$get("/cos/houses-info/housesConsumptionMonth",{housesId:this.housesId}).then(function(e){if(0!==e.data.data.length)t.$message.warning("该房屋本月已进行清算！");else{var a=[],n=[];t.propertyList.forEach(function(e){var s=0,o=e.price;1!==e.id&&2!==e.id||(n.push({housesId:t.housesId,type:e.id,year:(new Date).getFullYear(),month:Number((new Date).getMonth())+1,dose:1===e.id?t.energyNow:t.waterNow}),0===t.consumptionInfo.length?s=1===e.id?t.energyNow:t.waterNow:t.consumptionInfo.forEach(function(a){e.id===a.type&&1===e.id&&(s=Number(t.energyNow)-Number(a.dose)),e.id===a.type&&2===e.id&&(s=Number(t.waterNow)-Number(a.dose))}),1===e.id&&(o=t.electricityBill),2===e.id&&(o=t.waterBill)),3===e.id&&(o=e.price*t.housesData.usageArea),a.push({housesId:t.housesId,type:e.id,year:(new Date).getFullYear(),month:Number((new Date).getMonth())+1,dosage:s,price:o})}),t.$post("/cos/payment-manage/addPaymentManage",{paymentManageStr:i()(s()(a))}).then(function(e){t.$post("/cos/consumption-info/addConsumption",{consumptionInfoStr:i()(s()(n))}).then(function(e){t.electricityBill=0,t.waterBill=0,t.$emit("success")}).catch(function(){t.loading=!1})}).catch(function(){t.loading=!1})}})}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:"抄表入库",width:800},on:{cancel:t.onClose},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("template",{slot:"footer"},[a("a-button",{key:"back",on:{click:t.onClose}},[t._v("\n      取消\n    ")]),t._v(" "),a("a-button",{key:"submit",attrs:{type:"primary",loading:t.loading},on:{click:t.handleSubmit}},[t._v("\n      提交\n    ")])],1),t._v(" "),a("div",[a("a-row",{attrs:{gutter:20}},[a("a-col",{attrs:{span:14}},[a("a-form-item",t._b({attrs:{label:"所属房屋"}},"a-form-item",t.formItemLayout,!1),[a("a-select",{staticStyle:{width:"100%"},attrs:{showSearch:"",optionFilterProp:"children"},on:{change:t.housesChange},model:{value:t.housesId,callback:function(e){t.housesId=e},expression:"housesId"}},t._l(t.housesList,function(e,n){return a("a-select-option",{key:n,attrs:{value:e.id}},[t._v(t._s(e.address))])}))],1)],1),t._v(" "),null!==t.housesData?a("a-col",{attrs:{span:24}},[a("a-row",{attrs:{gutter:15}},[a("a-col",{attrs:{span:8}},[a("b",[t._v("本月电表指数（度）")]),t._v(" "),t._l(t.consumptionInfo,function(e,n){return 1==e.type?a("a-input-number",{key:n,staticStyle:{width:"100%"},attrs:{min:e.dose},on:{blur:t.energyChange},model:{value:t.energyNow,callback:function(e){t.energyNow=e},expression:"energyNow"}}):t._e()}),t._v(" "),0===t.consumptionInfo.length?a("a-input-number",{staticStyle:{width:"100%"},attrs:{min:.1},on:{blur:t.energyChange},model:{value:t.energyNow,callback:function(e){t.energyNow=e},expression:"energyNow"}}):t._e()],2),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("本月水表指数（吨）")]),t._v(" "),t._l(t.consumptionInfo,function(e,n){return 2==e.type?a("a-input-number",{key:n,staticStyle:{width:"100%"},attrs:{min:e.dose},on:{blur:t.waterChange},model:{value:t.waterNow,callback:function(e){t.waterNow=e},expression:"waterNow"}}):t._e()}),t._v(" "),0===t.consumptionInfo.length?a("a-input-number",{staticStyle:{width:"100%"},attrs:{min:.1},on:{blur:t.waterChange},model:{value:t.waterNow,callback:function(e){t.waterNow=e},expression:"waterNow"}}):t._e()],2)],1),t._v(" "),a("br"),t._v(" "),a("a-row",[a("a-col",{staticStyle:{"margin-bottom":"15px"}},[a("span",{staticStyle:{"font-size":"15px","font-weight":"650",color:"#000c17"}},[t._v("房屋信息")])]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("房间号：")]),t._v("\n            "+t._s(t.housesData.number)+" 室\n          ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("房屋地址：")]),t._v(" "),a("a-tooltip",[a("template",{slot:"title"},[t._v("\n                "+t._s(t.housesData.address)+"\n              ")]),t._v("\n              "+t._s(t.housesData.address.slice(0,10))+" ...\n            ")],2)],1),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("楼层：")]),t._v("\n            "+t._s(t.housesData.floor)+" 层\n          ")])],1),t._v(" "),a("br"),t._v(" "),a("a-row",[a("a-col",{attrs:{span:8}},[a("b",[t._v("使用面积：")]),t._v("\n            "+t._s(t.housesData.usageArea)+" ㎡\n          ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("建筑面积：")]),t._v("\n            "+t._s(t.housesData.surfaceArea)+" ㎡\n          ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("房屋类型：")]),t._v(" "),1==t.housesData.nature?a("span",[t._v("住宅楼房")]):t._e(),t._v(" "),2==t.housesData.nature?a("span",[t._v("社区用处")]):t._e()])],1),t._v(" "),a("br"),t._v(" "),a("a-row",[a("a-col",{attrs:{span:8}},[a("b",[t._v("间 数：")]),t._v("\n            "+t._s(t.housesData.rooms)+" 间\n          ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("购房人：")]),t._v("\n            "+t._s(t.housesData.buyer)+"\n          ")])],1),t._v(" "),a("br"),t._v(" "),a("br")],1):t._e(),t._v(" "),a("a-col",{attrs:{span:24}},t._l(t.propertyList,function(e,n){return a("a-row",{key:n},[a("a-col",{staticStyle:{"margin-bottom":"15px"}},[a("span",{staticStyle:{"font-size":"15px","font-weight":"650",color:"#000c17"}},[t._v("\n            "+t._s(e.name)+" -\n            "),1==e.type?a("span",[t._v("统一交付")]):t._e(),t._v(" "),2==e.type?a("span",[t._v("\n              按量计算\n              "),1==e.id?a("span",[a("a-tooltip",[a("template",{slot:"title"},[a("p",[t._v("第一档电量：每户每月0~200度 电费不做调整")]),t._v(" "),a("p",[t._v("第二档电量：每户每月201~400度 电价每度加0.05")]),t._v(" "),a("p",[t._v("第三档电量：每户每月400度以上 电价每度加0.3")])]),t._v(" "),a("a-icon",{attrs:{type:"question"}})],2)],1):t._e()]):t._e()])]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("价 格：")]),t._v(" "),1==e.type?a("span",[t._v(t._s(e.price)+" 元")]):t._e(),t._v(" "),2==e.type?a("span",[t._v(t._s(e.price)+" 元/ "+t._s(e.unit))]):t._e()]),t._v(" "),t._l(t.consumptionInfo,function(n,s){return n.type==e.id&&1==e.id?a("a-col",{key:s,attrs:{span:8}},[a("b",[t._v("上月用电：")]),t._v("\n            "+t._s(n.dose)+" "+t._s(e.unit)+"\n          ")]):t._e()}),t._v(" "),1==e.id&&0===t.consumptionInfo.length&&null!==t.housesData?a("a-col",{attrs:{span:8}},[a("b",[t._v("上月用电：")]),t._v(" - - ")]):t._e(),t._v(" "),1==e.id&&null!==t.housesData?a("a-col",{attrs:{span:8}},[a("b",[t._v("本月电费：")]),t._v(t._s(t.electricityBill)+" 元")]):t._e(),t._v(" "),3==e.id&&null!==t.housesData?a("a-col",{attrs:{span:8}},[a("b",[t._v("物业费用：")]),t._v("\n            "+t._s((t.housesData.usageArea*e.price).toFixed(2))+" 元\n          ")]):t._e(),t._v(" "),t._l(t.consumptionInfo,function(n,s){return n.type==e.id&&2==e.id?a("a-col",{key:s,attrs:{span:8}},[a("b",[t._v("上月用水：")]),t._v("\n            "+t._s(n.dose)+" "+t._s(e.unit)+"\n          ")]):t._e()}),t._v(" "),2==e.id&&0===t.consumptionInfo.length&&null!==t.housesData?a("a-col",{attrs:{span:8}},[a("b",[t._v("上月用水：")]),t._v(" - - ")]):t._e(),t._v(" "),2==e.id&&null!==t.housesData?a("a-col",{attrs:{span:8}},[a("b",[t._v("本月水费：")]),t._v(t._s(t.waterBill)+" 元")]):t._e(),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("br")],2)}))],1)],1)],2)},staticRenderFns:[]},v=a("VU/8")(p,d,!1,function(t){a("udUT")},"data-v-d9cbb7d0",null);e.default=v.exports},udUT:function(t,e){}});