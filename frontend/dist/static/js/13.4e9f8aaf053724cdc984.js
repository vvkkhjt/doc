webpackJsonp([13,33,73],{AQij:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=t("Dd8w"),i=t.n(r),n=t("JpjP"),s=t("V+G8"),o=t("Y2o2"),l=t("GaPQ"),c=t("NYxO"),p=t("PJh5");t.n(p).a.locale("zh-cn");var d={name:"repair",components:{RepairAdd:s.default,RepairEdit:o.default,RepairView:l.default,RangeDate:n.a},data:function(){return{advanced:!1,repairAdd:{visiable:!1},repairEdit:{visiable:!1,data:null},repairView:{visiable:!1,data:null},queryParams:{},filteredInfo:null,sortedInfo:null,paginationInfo:null,dataSource:[],selectedRowKeys:[],loading:!1,pagination:{pageSizeOptions:["10","20","30","40","100"],defaultCurrent:1,defaultPageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(e,a){return"显示 "+a[0]+" ~ "+a[1]+" 条记录，共 "+e+" 条记录"}},userList:[]}},computed:i()({},Object(c.c)({currentUser:function(e){return e.account.user}}),{columns:function(){var e=this.$createElement;return[{title:"维修编号",dataIndex:"code",scopedSlots:{customRender:"codeShow"}},{title:"求助人",dataIndex:"name"},{title:"联系方式",dataIndex:"phone"},{title:"维修类型",dataIndex:"repairType",customRender:function(a,t,r){switch(a){case"1":return e("a-tag",["上下水管道"]);case"2":return e("a-tag",["落水管"]);case"3":return e("a-tag",["水箱"]);case"4":return e("a-tag",["天线"]);case"5":return e("a-tag",["供电线路"]);case"6":return e("a-tag",["通讯线路"]);case"7":return e("a-tag",["照明"]);case"8":return e("a-tag",["供气线路"]);case"9":return e("a-tag",["消防设施"]);default:return"- -"}}},{title:"维修内容",dataIndex:"content",scopedSlots:{customRender:"contentShow"}},{title:"房屋地址",dataIndex:"address",scopedSlots:{customRender:"addressShow"}},{title:"照片",dataIndex:"images",customRender:function(a,t,r){return t.images?e("a-popover",[e("template",{slot:"content"},[e("a-avatar",{attrs:{shape:"square",size:132,icon:"user",src:"http://backend.my.org/imagesWeb/"+t.images.split(",")[0]}})]),e("a-avatar",{attrs:{shape:"square",icon:"user",src:"http://backend.my.org/imagesWeb/"+t.images.split(",")[0]}})]):e("a-avatar",{attrs:{shape:"square",icon:"user"}})}},{title:"维修状态",dataIndex:"repairStatus",customRender:function(a,t,r){switch(a){case 0:return e("a-tag",["未派修"]);case 1:return e("a-tag",{attrs:{color:"yellow"}},["已派修"]);case 2:return e("a-tag",{attrs:{color:"green"}},["已完成"]);default:return"- -"}}},{title:"创建时间",dataIndex:"createDate",customRender:function(e,a,t){return null!==e?e:"- -"}},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}]}}),mounted:function(){this.fetch()},methods:{view:function(e){this.repairView.data=e,this.repairView.visiable=!0},handleRepairViewClose:function(){this.repairView.visiable=!1},onSelectChange:function(e){this.selectedRowKeys=e},toggleAdvanced:function(){this.advanced=!this.advanced},add:function(){this.repairAdd.visiable=!0},handleRepairAddClose:function(){this.repairAdd.visiable=!1},handleRepairAddSuccess:function(){this.repairAdd.visiable=!1,this.$message.success("新增成功"),this.search()},edit:function(e){this.repairEdit.data=e,this.repairEdit.visiable=!0},handleRepairEditClose:function(){this.repairEdit.visiable=!1},handleRepairEditSuccess:function(){this.repairEdit.visiable=!1,this.$message.success("修改成功"),this.search()},handleDeptChange:function(e){this.queryParams.deptId=e||""},batchDelete:function(){if(this.selectedRowKeys.length){var e=this;this.$confirm({title:"确定删除所选中的记录?",content:"当您点击确定按钮后，这些记录将会被彻底删除",centered:!0,onOk:function(){var a=e.selectedRowKeys.join(",");e.$delete("/cos/repair-info/"+a).then(function(){e.$message.success("删除成功"),e.selectedRowKeys=[],e.search()})},onCancel:function(){e.selectedRowKeys=[]}})}else this.$message.warning("请选择需要删除的记录")},search:function(){var e=this.sortedInfo,a=this.filteredInfo,t=void 0,r=void 0;e&&(t=e.field,r=e.order),this.fetch(i()({sortField:t,sortOrder:r},this.queryParams,a))},reset:function(){this.selectedRowKeys=[],this.$refs.TableInfo.pagination.current=this.pagination.defaultCurrent,this.paginationInfo&&(this.paginationInfo.current=this.pagination.defaultCurrent,this.paginationInfo.pageSize=this.pagination.defaultPageSize),this.filteredInfo=null,this.sortedInfo=null,this.queryParams={},this.fetch()},handleTableChange:function(e,a,t){this.paginationInfo=e,this.filteredInfo=a,this.sortedInfo=t,this.fetch(i()({sortField:t.field,sortOrder:t.order},this.queryParams,a))},fetch:function(){var e=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,this.paginationInfo?(this.$refs.TableInfo.pagination.current=this.paginationInfo.current,this.$refs.TableInfo.pagination.pageSize=this.paginationInfo.pageSize,a.size=this.paginationInfo.pageSize,a.current=this.paginationInfo.current):(a.size=this.pagination.defaultPageSize,a.current=this.pagination.defaultCurrent),void 0===a.repairStatus&&delete a.repairStatus,this.$get("/cos/repair-info/page",i()({},a)).then(function(a){var t=a.data.data,r=i()({},e.pagination);r.total=t.total,e.dataSource=t.records,e.pagination=r,e.loading=!1})}},watch:{}},u={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-card",{staticClass:"card-area",attrs:{bordered:!1}},[t("div",{class:e.advanced?"search":null},[t("a-form",{attrs:{layout:"horizontal"}},[t("a-row",{attrs:{gutter:15}},[t("div",{class:e.advanced?null:"fold"},[t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"业主姓名",labelCol:{span:4},wrapperCol:{span:18,offset:2}}},[t("a-input",{model:{value:e.queryParams.name,callback:function(a){e.$set(e.queryParams,"name",a)},expression:"queryParams.name"}})],1)],1),e._v(" "),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"联系方式",labelCol:{span:4},wrapperCol:{span:18,offset:2}}},[t("a-input",{model:{value:e.queryParams.phone,callback:function(a){e.$set(e.queryParams,"phone",a)},expression:"queryParams.phone"}})],1)],1),e._v(" "),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"维修状态",labelCol:{span:4},wrapperCol:{span:18,offset:2}}},[t("a-select",{attrs:{allowClear:""},model:{value:e.queryParams.repairStatus,callback:function(a){e.$set(e.queryParams,"repairStatus",a)},expression:"queryParams.repairStatus"}},[t("a-select-option",{attrs:{value:"0"}},[e._v("未派修")]),e._v(" "),t("a-select-option",{attrs:{value:"1"}},[e._v("已派修")]),e._v(" "),t("a-select-option",{attrs:{value:"2"}},[e._v("已完成")])],1)],1)],1)],1),e._v(" "),t("span",{staticStyle:{float:"right","margin-top":"3px"}},[t("a-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")]),e._v(" "),t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")])],1)])],1)],1),e._v(" "),t("div",[t("div",{staticClass:"operator"},[t("a-button",{on:{click:e.batchDelete}},[e._v("删除")])],1),e._v(" "),t("a-table",{ref:"TableInfo",attrs:{columns:e.columns,rowKey:function(e){return e.id},dataSource:e.dataSource,pagination:e.pagination,loading:e.loading,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},scroll:{x:900}},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"codeShow",fn:function(a,r){return[[t("a-badge",{attrs:{status:"processing"}}),e._v("\n          "+e._s(r.code)+"\n        ")]]}},{key:"contentShow",fn:function(a,r){return[[t("a-tooltip",[t("template",{slot:"title"},[e._v("\n              "+e._s(r.content)+"\n            ")]),e._v("\n            "+e._s(r.content.slice(0,10))+" ...\n          ")],2)]]}},{key:"addressShow",fn:function(a,r){return[[t("a-tooltip",[t("template",{slot:"title"},[e._v("\n              "+e._s(r.address)+"\n            ")]),e._v("\n            "+e._s(r.address.slice(0,10))+" ...\n          ")],2)]]}},{key:"operation",fn:function(a,r){return[t("a-icon",{attrs:{type:"fork",title:"修 改"},on:{click:function(a){e.edit(r)}}})]}}])})],1),e._v(" "),e.repairAdd.visiable?t("repair-add",{attrs:{repairAddVisiable:e.repairAdd.visiable},on:{close:e.handleRepairAddClose,success:e.handleRepairAddSuccess}}):e._e(),e._v(" "),t("repair-edit",{ref:"repairEdit",attrs:{repairData:e.repairEdit.data,repairEditVisiable:e.repairEdit.visiable},on:{close:e.handleRepairEditClose,success:e.handleRepairEditSuccess}}),e._v(" "),t("repair-view",{attrs:{repairShow:e.repairView.visiable,repairData:e.repairView.data},on:{close:e.handleRepairViewClose}})],1)},staticRenderFns:[]},v=t("VU/8")(d,u,!1,function(e){t("Dk++")},"data-v-10196fe0",null);a.default=v.exports},DOTI:function(e,a){},"Dk++":function(e,a){},GaPQ:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=t("PJh5");t.n(r).a.locale("zh-cn");var i={name:"RepairView",props:{repairShow:{type:Boolean,default:!1},repairData:{type:Object}},computed:{show:{get:function(){return this.repairShow},set:function(){}}},data:function(){return{loading:!1}},methods:{onClose:function(){this.$emit("close")}}},n={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-modal",{attrs:{title:"维修上报",width:800},on:{cancel:e.onClose},model:{value:e.show,callback:function(a){e.show=a},expression:"show"}},[t("template",{slot:"footer"},[t("a-button",{key:"back",attrs:{type:"danger"},on:{click:e.onClose}},[e._v("\n      关闭\n    ")])],1),e._v(" "),null!==e.repairData?t("div",{staticStyle:{"font-size":"13px"}},[t("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[t("a-col",{staticStyle:{"margin-bottom":"15px"}},[t("span",{staticStyle:{"font-size":"15px","font-weight":"650",color:"#000c17"}},[e._v("业主信息")])]),e._v(" "),t("a-col",{attrs:{span:8}},[t("b",[e._v("业主姓名：")]),e._v("\n        "+e._s(e.repairData.name)+"\n      ")]),e._v(" "),t("a-col",{attrs:{span:8}},[t("b",[e._v("联系电话：")]),e._v("\n        "+e._s(e.repairData.phone)+"\n      ")]),e._v(" "),t("a-col",{attrs:{span:8}},[t("b",[e._v("身份证号：")]),e._v(" "),t("a-tooltip",[t("template",{slot:"title"},[e._v("\n            "+e._s(e.repairData.idNumber)+"\n          ")]),e._v("\n          "+e._s(e.repairData.idNumber.slice(0,10))+" ...\n        ")],2)],1)],1),e._v(" "),t("br")],1):e._e()],2)},staticRenderFns:[]},s=t("VU/8")(i,n,!1,function(e){t("DOTI")},"data-v-c97795dc",null);a.default=s.exports},PWeS:function(e,a){},Y2o2:function(e,a,t){"use strict";function r(e){return new v.a(function(a,t){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return a(r.result)},r.onerror=function(e){return t(e)}})}Object.defineProperty(a,"__esModule",{value:!0});var i=t("woOf"),n=t.n(i),s=t("Xxa5"),o=t.n(s),l=t("exGp"),c=t.n(l),p=t("Dd8w"),d=t.n(p),u=t("//Fk"),v=t.n(u),f=t("NYxO"),h={labelCol:{span:24},wrapperCol:{span:24}},_={name:"RepairEdit",props:{repairEditVisiable:{default:!1},repairData:{type:Object}},watch:{repairEditVisiable:function(e){e&&null!==this.repairData.images&&""!==this.repairData.images&&this.imagesInit(this.repairData.images)}},computed:d()({},Object(f.c)({currentUser:function(e){return e.account.user}}),{show:{get:function(){return this.repairEditVisiable},set:function(){}}}),mounted:function(){this.getWorkerList()},data:function(){return{rowId:null,formItemLayout:h,form:this.$form.createForm(this),loading:!1,fileList:[],previewVisible:!1,previewImage:"",workerId:null,workerList:""}},methods:{getWorkerList:function(){var e=this;this.$get("/cos/worker-info/list",{type:2}).then(function(a){e.workerList=a.data.data})},handleCancel:function(){this.previewVisible=!1},handlePreview:function(e){var a=this;return c()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.url||e.preview){t.next=4;break}return t.next=3,r(e.originFileObj);case 3:e.preview=t.sent;case 4:a.previewImage=e.url||e.preview,a.previewVisible=!0;case 6:case"end":return t.stop()}},t,a)}))()},picHandleChange:function(e){var a=e.fileList;this.fileList=a},imagesInit:function(e){if(null!==e&&""!==e){var a=[];e.split(",").forEach(function(e,t){a.push({uid:t,name:e,status:"done",url:"http://backend.my.org/imagesWeb/"+e})}),this.fileList=a}},reset:function(){this.loading=!1,this.form.resetFields()},onClose:function(){this.reset(),this.$emit("close")},handleSubmit:function(){var e=this,a=n()(this.repairData,{});null!==this.workerId?(a.worker=this.workerId,this.$put("/cos/repair-info",a).then(function(a){e.workerId=null,e.$emit("success")}).catch(function(){e.loading=!1})):this.$message.warning("请选择工作人员！")}}},g={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-modal",{attrs:{title:"选择工作人员",width:800},on:{cancel:e.onClose},model:{value:e.show,callback:function(a){e.show=a},expression:"show"}},[t("template",{slot:"footer"},[t("a-button",{key:"back",on:{click:e.onClose}},[e._v("\n      关闭\n    ")])],1),e._v(" "),null!==e.repairData?t("div",{staticStyle:{"font-size":"13px"}},[t("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[t("a-col",{staticStyle:{"margin-bottom":"15px"}},[t("span",{staticStyle:{"font-size":"15px","font-weight":"650",color:"#000c17"}},[e._v("基础信息")])]),e._v(" "),t("a-col",{attrs:{span:8}},[t("b",[e._v("业主姓名：")]),e._v("\n        "+e._s(e.repairData.name)+"\n      ")]),e._v(" "),t("a-col",{attrs:{span:8}},[t("b",[e._v("联系电话：")]),e._v("\n        "+e._s(e.repairData.phone)+"\n      ")]),e._v(" "),t("a-col",{attrs:{span:8}},[t("b",[e._v("上次登陆时间：")]),e._v("\n        "+e._s(null!==e.repairData.lastTime?e.repairData.lastTime:"- -")+"\n      ")])],1),e._v(" "),t("br"),e._v(" "),t("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[t("a-col",{attrs:{span:8}},[t("b",[e._v("维修编号：")]),e._v("\n        "+e._s(e.repairData.code)+"\n      ")]),e._v(" "),t("a-col",{attrs:{span:16}},[t("b",[e._v("维修内容：")]),e._v("\n        "+e._s(e.repairData.content)+"\n      ")])],1),e._v(" "),t("br"),e._v(" "),t("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[t("a-col",{attrs:{span:24}},[t("a-upload",{attrs:{name:"avatar",action:"http://backend.my.org/file/fileUpload/","list-type":"picture-card",disabled:"","file-list":e.fileList},on:{preview:e.handlePreview,change:e.picHandleChange}}),e._v(" "),t("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[t("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1)],1),e._v(" "),t("br"),e._v(" "),t("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[t("a-col",{attrs:{span:8}},[t("b",[e._v("维修类型：")]),e._v(" "),1==e.repairData.repairType?t("span",[e._v("上下水管道")]):e._e(),e._v(" "),2==e.repairData.repairType?t("span",[e._v("落水管")]):e._e(),e._v(" "),3==e.repairData.repairType?t("span",[e._v("水箱")]):e._e(),e._v(" "),4==e.repairData.repairType?t("span",[e._v("天线")]):e._e(),e._v(" "),5==e.repairData.repairType?t("span",[e._v("供电线路")]):e._e(),e._v(" "),6==e.repairData.repairType?t("span",[e._v("通讯线路")]):e._e(),e._v(" "),7==e.repairData.repairType?t("span",[e._v("照明")]):e._e(),e._v(" "),8==e.repairData.repairType?t("span",[e._v("供气线路")]):e._e(),e._v(" "),9==e.repairData.repairType?t("span",[e._v("消防设施")]):e._e()]),e._v(" "),t("a-col",{attrs:{span:8}},[t("b",[e._v("维修状态：")]),e._v(" "),0==e.repairData.repairStatus?t("span",[e._v("未派修")]):e._e(),e._v(" "),1==e.repairData.repairStatus?t("span",[e._v("已派修")]):e._e(),e._v(" "),2==e.repairData.repairStatus?t("span",[e._v("已完成")]):e._e()]),e._v(" "),t("a-col",{attrs:{span:8}},[t("b",[e._v("创建时间：")]),e._v("\n        "+e._s(e.repairData.createDate)+"\n      ")])],1),e._v(" "),t("br"),e._v(" "),t("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[t("a-col",{attrs:{span:8}},[t("b",[e._v("房屋地址：")]),e._v(" "),t("a-tooltip",[t("template",{slot:"title"},[e._v("\n            "+e._s(e.repairData.address)+"\n          ")]),e._v("\n          "+e._s(e.repairData.address.slice(0,10))+" ...\n        ")],2)],1),e._v(" "),t("a-col",{attrs:{span:8}},[t("b",[e._v("房间号：")]),e._v("\n        "+e._s(e.repairData.number)+" 室\n      ")]),e._v(" "),t("a-col",{attrs:{span:8}},[t("b",[e._v("楼层：")]),e._v("\n        "+e._s(e.repairData.floor)+" 层\n      ")])],1),e._v(" "),t("br"),e._v(" "),t("br"),e._v(" "),null!==e.repairData.worker?t("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[t("a-col",{staticStyle:{"margin-bottom":"15px"}},[t("span",{staticStyle:{"font-size":"15px","font-weight":"650",color:"#000c17"}},[e._v("维修员工信息")])]),e._v(" "),t("a-col",{attrs:{span:8}},[t("b",[e._v("员工姓名：")]),e._v(" "),t("a-popover",[t("template",{slot:"content"},[null!==e.repairData.workerImage?t("a-avatar",{attrs:{shape:"square",size:132,icon:"user",src:"http://backend.my.org/imagesWeb/"+e.repairData.workerImage.split(",")[0]}}):t("a-avatar",{attrs:{shape:"square",size:132,icon:"user"}})],1),e._v(" "),t("a",[e._v(e._s(null!==e.repairData.workerName?e.repairData.workerName:"- -"))])],2)],1),e._v(" "),t("a-col",{attrs:{span:8}},[t("b",[e._v("联系电话：")]),e._v("\n        "+e._s(e.repairData.workerPhone)+"\n      ")])],1):e._e(),e._v(" "),t("br"),e._v(" "),t("br"),e._v(" "),t("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"},attrs:{gutter:15}},[t("a-col",{staticStyle:{"margin-bottom":"15px"}},[t("span",{staticStyle:{"font-size":"15px","font-weight":"650",color:"#000c17"}},[e._v("更换维修员工")])]),e._v(" "),t("a-col",{attrs:{span:10}},[t("a-select",{staticStyle:{width:"100%"},model:{value:e.workerId,callback:function(a){e.workerId=a},expression:"workerId"}},e._l(e.workerList,function(a,r){return t("a-select-option",{key:r,attrs:{value:a.id}},[e._v(e._s(a.name))])}))],1),e._v(" "),t("a-col",{attrs:{span:3}},[t("a-button",{key:"back",on:{click:e.handleSubmit}},[e._v("\n          提交\n        ")])],1)],1)],1):e._e()],2)},staticRenderFns:[]},m=t("VU/8")(_,g,!1,function(e){t("PWeS")},"data-v-2f8f4c1a",null);a.default=m.exports}});