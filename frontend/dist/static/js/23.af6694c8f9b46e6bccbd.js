webpackJsonp([23,69],{"+CQr":function(t,e){},"3/te":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("PJh5");a.n(n).a.locale("zh-cn");var s={name:"PaymentView",props:{paymentShow:{type:Boolean,default:!1},paymentData:{type:Object}},computed:{show:{get:function(){return this.paymentShow},set:function(){}}},data:function(){return{loading:!1}},methods:{onClose:function(){this.$emit("close")}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:"缴费管理详情",width:800},on:{cancel:t.onClose},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("template",{slot:"footer"},[a("a-button",{key:"back",attrs:{type:"danger"},on:{click:t.onClose}},[t._v("\n      关闭\n    ")])],1),t._v(" "),null!==t.paymentData?a("div",{staticStyle:{"font-size":"13px"}},[a("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[a("a-col",{staticStyle:{"margin-bottom":"15px"}},[a("span",{staticStyle:{"font-size":"15px","font-weight":"650",color:"#000c17"}},[t._v("基础信息")])]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("业主姓名：")]),t._v("\n        "+t._s(t.paymentData.name)+"\n      ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("联系电话：")]),t._v("\n        "+t._s(t.paymentData.phone)+"\n      ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("身份证号：")]),t._v(" "),a("a-tooltip",[a("template",{slot:"title"},[t._v("\n            "+t._s(t.paymentData.idNumber)+"\n          ")]),t._v("\n          "+t._s(t.paymentData.idNumber.slice(0,10))+" ...\n        ")],2)],1)],1),t._v(" "),a("br"),t._v(" "),a("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[a("a-col",{attrs:{span:8}},[a("b",[t._v("收取年份：")]),t._v("\n        "+t._s(t.paymentData.year)+" 年\n      ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("收取月份：")]),t._v("\n        "+t._s(t.paymentData.month)+" 月\n      ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("房屋地址：")]),t._v(" "),a("a-tooltip",[a("template",{slot:"title"},[t._v("\n            "+t._s(t.paymentData.address)+"\n          ")]),t._v("\n          "+t._s(t.paymentData.address.slice(0,10))+" ...\n        ")],2)],1)],1),t._v(" "),a("br"),t._v(" "),a("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[a("a-col",{attrs:{span:8}},[a("b",[t._v("缴费类型：")]),t._v("\n        "+t._s(t.paymentData.propertyName)+"\n      ")]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("本月消耗：")]),t._v(" "),1==t.paymentData.type||2==t.paymentData.type?a("span",[t._v(t._s(t.paymentData.propertyName)+" "+t._s(t.paymentData.dosage)+" "+t._s(t.paymentData.propertyUnit))]):a("span",[t._v("- -")])]),t._v(" "),a("a-col",{attrs:{span:8}},[a("b",[t._v("需缴费用：")]),t._v("\n        "+t._s(t.paymentData.price)+" 元\n      ")])],1),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("a-row",{staticStyle:{"padding-left":"24px","padding-right":"24px"}},[a("a-col",{staticStyle:{"margin-bottom":"15px"}},[a("span",{staticStyle:{"font-size":"15px","font-weight":"650",color:"#000c17"}},[t._v("电费梯度计算")])]),t._v(" "),a("a-col",{attrs:{span:24}},[a("b",[t._v("第一档电量：")]),t._v("\n        每户每月0~200度 电费不做调整\n      ")]),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("a-col",{attrs:{span:24}},[a("b",[t._v("第二档电量：")]),t._v("\n        每户每月201~400度 电价每度加0.05\n      ")]),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("a-col",{attrs:{span:24}},[a("b",[t._v("第三档电量：")]),t._v("\n        每户每月400度以上 电价每度加0.3\n      ")])],1),t._v(" "),a("br")],1):t._e()],2)},staticRenderFns:[]},o=a("VU/8")(s,i,!1,function(t){a("F9UN")},"data-v-4203f642",null);e.default=o.exports},F9UN:function(t,e){},fWpR:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(a("mvHQ"),a("Dd8w")),s=a.n(n),i=a("JpjP"),o=a("3/te"),r=a("NYxO"),l=a("PJh5");a.n(l).a.locale("zh-cn");var c={name:"payment",components:{PaymentView:o.default,RangeDate:i.a},data:function(){return{advanced:!1,paymentAdd:{visiable:!1},paymentEdit:{visiable:!1},paymentView:{visiable:!1,data:null},queryParams:{},filteredInfo:null,sortedInfo:null,paginationInfo:null,dataSource:[],selectedRowKeys:[],loading:!1,pagination:{pageSizeOptions:["10","20","30","40","100"],defaultCurrent:1,defaultPageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(t,e){return"显示 "+e[0]+" ~ "+e[1]+" 条记录，共 "+t+" 条记录"}},propertyList:[]}},computed:s()({},Object(r.c)({currentUser:function(t){return t.account.user}}),{columns:function(){var t=this.$createElement;return[{title:"所属房屋",dataIndex:"address",scopedSlots:{customRender:"addressShow"}},{title:"业主姓名",dataIndex:"name"},{title:"联系方式",dataIndex:"phone"},{title:"缴费金额",dataIndex:"price",customRender:function(t,e,a){return null!==t?"￥"+t:"- -"}},{title:"缴费类型",dataIndex:"propertyName",scopedSlots:{customRender:"propertyNameShow"}},{title:"计算方式",dataIndex:"propertyType",customRender:function(e,a,n){switch(e){case 1:return t("a-tag",["统一交付"]);case 2:return t("a-tag",["按量计算"]);default:return"- -"}}},{title:"费用时间",dataIndex:"year",customRender:function(t,e,a){return e.year+"年"+e.month+"月"}},{title:"缴费状态",dataIndex:"createDate",customRender:function(e,a,n){return null!==e?t("a-tag",{attrs:{color:"green"}},["已缴费"]):t("a-tag",{attrs:{color:"red"}},["未缴费"])}},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}]}}),mounted:function(){this.fetch(),this.getPropertyList()},methods:{pay:function(t){var e={outTradeNo:t.id,subject:t.year+"年"+t.month+"月"+t.propertyName,totalAmount:t.price,body:""};this.$post("/cos/pay/alipay",e).then(function(t){var e=document.getElementsByTagName("div");e.length&&document.body.removeChild(e[0]);var a=document.createElement("div");a.innerHTML=t.data.msg,document.body.appendChild(a),document.forms[0].setAttribute("target","_self"),document.forms[0].submit()})},getPropertyList:function(){var t=this;this.$get("/cos/property-item/list").then(function(e){t.propertyList=e.data.data})},view:function(t){this.paymentView.data=t,this.paymentView.visiable=!0},handlePaymentViewClose:function(){this.paymentView.visiable=!1},onSelectChange:function(t){this.selectedRowKeys=t},toggleAdvanced:function(){this.advanced=!this.advanced},add:function(){this.paymentAdd.visiable=!0},handlePaymentAddClose:function(){this.paymentAdd.visiable=!1},handlePaymentAddSuccess:function(){this.paymentAdd.visiable=!1,this.$message.success("添加成功"),this.search()},edit:function(t){this.$refs.paymentEdit.setFormValues(t),this.paymentEdit.visiable=!0},handlePaymentEditClose:function(){this.paymentEdit.visiable=!1},handlePaymentEditSuccess:function(){this.paymentEdit.visiable=!1,this.$message.success("修改工作人员成功"),this.search()},handleDeptChange:function(t){this.queryParams.deptId=t||""},batchDelete:function(){if(this.selectedRowKeys.length){var t=this;this.$confirm({title:"确定删除所选中的记录?",content:"当您点击确定按钮后，这些记录将会被彻底删除",centered:!0,onOk:function(){var e=t.selectedRowKeys.join(",");t.$delete("/cos/payment-info/"+e).then(function(){t.$message.success("删除成功"),t.selectedRowKeys=[],t.search()})},onCancel:function(){t.selectedRowKeys=[]}})}else this.$message.warning("请选择需要删除的记录")},search:function(){var t=this.sortedInfo,e=this.filteredInfo,a=void 0,n=void 0;t&&(a=t.field,n=t.order),this.fetch(s()({sortField:a,sortOrder:n},this.queryParams,e))},reset:function(){this.selectedRowKeys=[],this.$refs.TableInfo.pagination.current=this.pagination.defaultCurrent,this.paginationInfo&&(this.paginationInfo.current=this.pagination.defaultCurrent,this.paginationInfo.pageSize=this.pagination.defaultPageSize),this.filteredInfo=null,this.sortedInfo=null,this.queryParams={},this.fetch()},handleTableChange:function(t,e,a){this.paginationInfo=t,this.filteredInfo=e,this.sortedInfo=a,this.fetch(s()({sortField:a.field,sortOrder:a.order},this.queryParams,e))},fetch:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,this.paginationInfo?(this.$refs.TableInfo.pagination.current=this.paginationInfo.current,this.$refs.TableInfo.pagination.pageSize=this.paginationInfo.pageSize,e.size=this.paginationInfo.pageSize,e.current=this.paginationInfo.current):(e.size=this.pagination.defaultPageSize,e.current=this.pagination.defaultCurrent),void 0===e.type&&delete e.type,e.userId=this.currentUser.userId,this.$get("/cos/payment-manage/page",s()({},e)).then(function(e){var a=e.data.data,n=s()({},t.pagination);n.total=a.total,t.dataSource=a.records,t.pagination=n,t.loading=!1})}},watch:{}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",{staticClass:"card-area",attrs:{bordered:!1}},[a("div",{class:t.advanced?"search":null},[a("a-form",{attrs:{layout:"horizontal"}},[a("a-row",{attrs:{gutter:15}},[a("div",{class:t.advanced?null:"fold"},[a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"房屋地址",labelCol:{span:4},wrapperCol:{span:18,offset:2}}},[a("a-input",{model:{value:t.queryParams.address,callback:function(e){t.$set(t.queryParams,"address",e)},expression:"queryParams.address"}})],1)],1),t._v(" "),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"缴费类型",labelCol:{span:4},wrapperCol:{span:18,offset:2}}},[a("a-select",{attrs:{allowClear:""},model:{value:t.queryParams.type,callback:function(e){t.$set(t.queryParams,"type",e)},expression:"queryParams.type"}},t._l(t.propertyList,function(e,n){return a("a-select-option",{key:n,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],1)],1)],1),t._v(" "),a("span",{staticStyle:{float:"right","margin-top":"3px"}},[a("a-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")]),t._v(" "),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.reset}},[t._v("重置")])],1)])],1)],1),t._v(" "),a("div",[a("div",{staticClass:"operator"},[a("a-button",{on:{click:t.batchDelete}},[t._v("删除")])],1),t._v(" "),a("a-table",{ref:"TableInfo",attrs:{columns:t.columns,rowKey:function(t){return t.id},dataSource:t.dataSource,pagination:t.pagination,loading:t.loading,rowSelection:{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange},scroll:{x:900}},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"propertyNameShow",fn:function(e,n){return[[1==n.type||2==n.type?a("a-tooltip",[a("template",{slot:"title"},[t._v("\n                本月消耗 - "+t._s(n.dosage)+" "+t._s(n.propertyUnit)+"\n              ")]),t._v(" "),a("a",[t._v(t._s(n.propertyName))])],2):a("span",[t._v(t._s(n.propertyName))])]]}},{key:"addressShow",fn:function(e,n){return[[a("a-tooltip",[a("template",{slot:"title"},[t._v("\n                "+t._s(n.address)+"\n              ")]),t._v("\n              "+t._s(n.address.slice(0,10))+" ...\n            ")],2)]]}},{key:"operation",fn:function(e,n){return[a("a-icon",{staticStyle:{"margin-right":"15px"},attrs:{type:"reconciliation",title:"查 看"},on:{click:function(e){t.view(n)}}}),t._v(" "),null===n.createDate?a("a-icon",{attrs:{type:"alipay",title:"支 付"},on:{click:function(e){t.pay(n)}}}):t._e()]}}])})],1),t._v(" "),a("payment-view",{attrs:{paymentShow:t.paymentView.visiable,paymentData:t.paymentView.data},on:{close:t.handlePaymentViewClose}})],1)},staticRenderFns:[]},p=a("VU/8")(c,d,!1,function(t){a("+CQr")},"data-v-6455409a",null);e.default=p.exports}});